<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>ThreeSixty.js â€” 96f Sprite</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@mladenilic/threesixty.js/dist/threesixty.js"></script>
  <style>
    #viewer { width: 600px; height: 600px; margin: 24px auto; }
    .toolbar { display: flex; justify-content: center; margin-top: 12px; }
    .controls { max-width: 720px; margin: 0 auto; }
  </style>
</head>
<body class="bg-light">

<div class="controls container mt-3">
  <div class="row g-2 align-items-center">
    <div class="col-auto"><label for="objectSelect" class="col-form-label">Object</label></div>
    <div class="col">
      <select id="objectSelect" class="form-select"></select>
    </div>
  </div>
</div>

<div id="viewer" class="bg-white rounded-3"></div>

<div class="toolbar">
  <div class="btn-group btn-group-sm" role="group" aria-label="View controls">
    <button class="btn btn-outline-secondary" data-view="front">Front</button>
    <button class="btn btn-outline-secondary" data-view="right">Right</button>
    <button class="btn btn-outline-secondary" data-view="back">Back</button>
    <button class="btn btn-outline-secondary" data-view="left">Left</button>
  </div>
</div>

<script>
  const CONFIG = {
    objects: [
      {
        name: "test-ring-1",
        views: { front: 13, left: 37, back: 60, right: 85 }
      }
    ]
  }

  const COUNT = 96, PERROW = 12
  const ts = new ThreeSixty(document.getElementById('viewer'), {
    image: './sprites/ring/ring.webp',
    width: 400, height: 400,
    count: COUNT, perRow: PERROW,
    draggable: true, swipeable: true, keys: true,
    speed: 50
  })

  const objectSelect = document.getElementById('objectSelect')
  CONFIG.objects.forEach((o, i) => {
    const opt = document.createElement('option')
    opt.value = i
    opt.textContent = o.name
    objectSelect.appendChild(opt)
  })

  let current = CONFIG.objects[0]

  function setFrame(f){ ts.goto(f) }

  setFrame(current.views.front)

  objectSelect.addEventListener('change', () => {
    current = CONFIG.objects[objectSelect.value|0]
    ts.stop()
    setFrame(current.views.front)
  })

  document.querySelector('.btn-group').addEventListener('click', e => {
    const v = e.target.dataset.view
    if(!v) return
    ts.stop()
    const idx = current.views[v]
    if(Number.isInteger(idx)) setFrame(idx)
  })

  ts.play(true, 2)
</script>

</body>
</html>
